<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="qzwslrm">
<title>Generate Test Data for qzwslrm • qzwslrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Test Data for qzwslrm">
<meta property="og:description" content="qzwslrm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">qzwslrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/generate_qzwslrm_test_data.html">Generate Test Data for qzwslrm</a>
    <a class="dropdown-item" href="../articles/howto.html">How To Use qzwslrm</a>
    <a class="dropdown-item" href="../articles/qzwslrm_dev.html">Development of Package qzwslrm</a>
    <a class="dropdown-item" href="../articles/qzwslrm_ebv_mix99.html">Prediction of Breeding Values Using MiX99</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generate Test Data for qzwslrm</h1>
            
      
      
      <div class="d-none name"><code>generate_qzwslrm_test_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">qzwslrm</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>The process of generating test data used in the package
<code>qzwslrm</code> is documented. The process of generating the data
file and the pedigree is done only once and these files are then stored
under the <code>extdata</code> directory of this package. Hence most of
the following R-code chunks are not evaluated, but they are visible for
documentation.</p>
</div>
<div class="section level2">
<h2 id="data-simulation">Data Simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h2>
<p>The functionality implemented in <code>qzwslrm</code> is tested with
a dataset that is generated using the simulation program
<code>QMSim</code>. The parameter input for <code>QMSim</code> was taken
from <a href="http://dx.doi.org/10.3168/jds.2019-16603" class="external-link">Macedo et al
(2020)</a> and was adapted. The main difference to the original input
parameter is the reduction of the number of male and female animals per
generation. To get smaller datafiles, the number of animals per
generation was reduced by a factor of <span class="math inline">\(100\)</span>. With the input parameters the
simulation was started as shown below</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_prm_file</span> <span class="op">&lt;-</span> <span class="st">"qzwslrm_test.prm"</span>
<span class="va">s_sim_param_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qmsim"</span>, <span class="va">s_prm_file</span>, package <span class="op">=</span> <span class="st">"qzwslrm"</span><span class="op">)</span>
<span class="va">qmsim_cmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"/qualstorzws01/data_projekte/linuxBin/QMSim"</span>, <span class="va">s_sim_param_path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span>command <span class="op">=</span> <span class="va">qmsim_cmd</span><span class="op">)</span></code></pre></div>
<p>Reproducibility of the data simulation is provided by moving the seed
file to the QMSim data directory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_seed_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="st">"seed.prv"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html" class="external-link">file_exists</a></span><span class="op">(</span><span class="va">s_seed_path</span><span class="op">)</span><span class="op">)</span>
  <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_move.html" class="external-link">file_move</a></span><span class="op">(</span><span class="va">s_seed_path</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"qmsim"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phenotypic-data">Phenotypic Data<a class="anchor" aria-label="anchor" href="#phenotypic-data"></a>
</h2>
<p><code>QMSim</code> produces a number of output files. For the
development and the tests of this package, we mainly require the
phenotypic data store in a file called p1_data_001.txt. This file is
copied to the system files of this package</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qmsim_out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignettes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"r_"</span>, <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path_file.html" class="external-link">path_ext_remove</a></span><span class="op">(</span><span class="va">s_prm_file</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">s_phen_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">qmsim_out_dir</span>, <span class="va">s_qmsim_phen_file</span><span class="op">)</span>
<span class="va">qmsim_ext_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"qmsim"</span><span class="op">)</span>
<span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_move.html" class="external-link">file_move</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">s_phen_path</span>, new_path <span class="op">=</span> <span class="va">qmsim_ext_dir</span><span class="op">)</span>
<span class="co"># remove old qmsim output directory</span>
<span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/delete.html" class="external-link">dir_delete</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">qmsim_out_dir</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prediction-of-breeding-values">Prediction of Breeding Values<a class="anchor" aria-label="anchor" href="#prediction-of-breeding-values"></a>
</h2>
<p>The file with the phenotypic data is used to predict breeding values
using <code>mix99</code>. Before we can run the analysis with
<code>mix99</code>, the data must be prepared and re-formatted.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_qsim_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"qmsim"</span>, <span class="va">s_qmsim_phen_file</span>, package <span class="op">=</span> <span class="st">"qzwslrm"</span><span class="op">)</span>
<span class="co"># count number of lines</span>
<span class="va">n_nr_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span>command <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"wc -l "</span>, <span class="va">s_qsim_data_path</span>, <span class="st">" | cut -d ' ' -f1"</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, intern <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co"># read qmsim data</span>
<span class="va">tbl_qm_data</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html" class="external-link">read_table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">s_qsim_data_path</span>, na <span class="op">=</span> <span class="st">'---'</span>, guess_max <span class="op">=</span> <span class="va">n_nr_lines</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tbl_qm_data</span><span class="op">)</span>
<span class="co">#&gt; [1] 4995   14</span></code></pre></div>
<div class="section level3">
<h3 id="generate-data-for-mix99">Generate Data for MiX99<a class="anchor" aria-label="anchor" href="#generate-data-for-mix99"></a>
</h3>
<p>To create a phenotype input file for <code>mix99</code>, the data is
filtered and a few columns are selected.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="va">tbl_mix99_data</span> <span class="op">&lt;-</span> <span class="va">tbl_qm_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Phen</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">Sex</span>, `M` <span class="op">=</span> <span class="fl">1</span>, `F` <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Progeny</span>, <span class="va">Sex</span>, <span class="va">Phen</span><span class="op">)</span></code></pre></div>
<p>As checks, the number of records are reported here</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tbl_mix99_data</span><span class="op">)</span>
<span class="co">#&gt; [1] 2679    3</span></code></pre></div>
<p>The first few lines of the selected data is shown</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl_mix99_data</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;   Progeny   Sex   Phen</span>
<span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      46     2 -<span style="color: #BB0000;">0.351</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      47     2 -<span style="color: #BB0000;">0.754</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      48     2  0.603</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      49     2  1.30 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>      50     2  2.44 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>      51     2  0.941</span></code></pre></div>
<p>The phenotypic data is written to a file</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_mix99_data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"mix99"</span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html" class="external-link">dir_exists</a></span><span class="op">(</span><span class="va">s_mix99_data_dir</span><span class="op">)</span><span class="op">)</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html" class="external-link">dir_create</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">s_mix99_data_dir</span><span class="op">)</span>
<span class="va">s_mix99_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">s_mix99_data_dir</span>, <span class="st">"p1_data_001.dat"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_delim</a></span><span class="op">(</span><span class="va">tbl_mix99_data</span>, file <span class="op">=</span> <span class="va">s_mix99_data_path</span>, delim <span class="op">=</span> <span class="st">" "</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-pedigree-for-mix99">Generate Pedigree for MiX99<a class="anchor" aria-label="anchor" href="#generate-pedigree-for-mix99"></a>
</h3>
<p>From the QMSim data the pedigree is generated.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl_mix99_ped</span> <span class="op">&lt;-</span> <span class="va">tbl_qm_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Progeny</span>, <span class="va">Sire</span>, <span class="va">Dam</span><span class="op">)</span></code></pre></div>
<p>Check the generated tibble</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">tbl_mix99_ped</span><span class="op">)</span>
<span class="co">#&gt; [1] 4995    3</span></code></pre></div>
<p>The first lines</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tbl_mix99_ped</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;   Progeny  Sire   Dam</span>
<span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       2     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       3     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>       4     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>       5     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>       6     0     0</span></code></pre></div>
<p>Write the pedigree to a file</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_mix99_ped_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">s_mix99_data_dir</span>, <span class="st">"p1_data_001.ped"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_delim</a></span><span class="op">(</span><span class="va">tbl_mix99_ped</span>, file <span class="op">=</span> <span class="va">s_mix99_ped_path</span>, delim <span class="op">=</span> <span class="st">" "</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-clim-file">Create CLIM File<a class="anchor" aria-label="anchor" href="#create-clim-file"></a>
</h3>
<p>The CLIM file is the instruction file that is used by MiX99. In this
file the phenotypes, the pedigree, the parameters and the model are
specified.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_mix99_data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"mix99"</span><span class="op">)</span>
<span class="va">s_mix99_clm_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">s_mix99_data_dir</span>, <span class="st">'p1_data_001.clm'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'#------------------------------------------------------------------\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'#                              CLIM\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'#           Command file for a simple animal model analysis.\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'#             MODEL:  phen = sex + animal\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'#------------------------------------------------------------------\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'DATAFILE  p1_data_001.dat        # Data file\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'MISSING -99999.0        # Number for missing real number\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'INTEGER   animal sex    # Integer column names\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'REAL      phen          # Real column names\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'PEDFILE   p1_data_001.ped        # Pedigree file\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'PEDIGREE  animal am     # Genetics associated with animal code: am=animal model \n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'PARFILE   p1_data_001.var        # Variance component file\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'PRECON b f              # Preconditioner: b=block\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'MODEL\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'  phen = sex animal # The model\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_clm_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="writing-parameter-file">Writing Parameter File<a class="anchor" aria-label="anchor" href="#writing-parameter-file"></a>
</h3>
<p>The parameter file is the input file that contains the
variance-covariance components.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_mix99_data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"mix99"</span><span class="op">)</span>
<span class="va">s_mix99_var_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">s_mix99_data_dir</span>, <span class="st">'p1_data_001.var'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'1  1  1  0.1\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_var_path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">'2  1  1  0.9\n'</span>, file <span class="op">=</span> <span class="va">s_mix99_var_path</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>With all the above components, it should be possible to run
predictions of breeding values using MiX99.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter von Rohr.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
